init python:
    magic_questions = [
        {
            "text": "Какой магический элемент наиболее непредсказуем?",
            "answers": [
                {"text": "Огонь. Он приносит как тепло, так и разрушение.", "correct": True},
                {"text": "Вода. Она подстраивается под любую форму.", "correct": False},
                {"text": "Тьма. Никто до конца не знает её природы.", "correct": False}
            ]
        },
        {
            "text": "Что важнее для сильного мага?",
            "answers": [
                {"text": "Сила. Без неё заклинания бесполезны.", "correct": False},
                {"text": "Контроль. Магия без контроля разрушительна.", "correct": True},
                {"text": "Наследие. Истинная мощь передаётся по крови.", "correct": False}
            ]
        },
        {
            "text": "Почему маги используют жесты и слова при заклинаниях?",
            "answers": [
                {"text": "Так магия лучше понимает их намерения.", "correct": True},
                {"text": "Они просто создают зрелищность.", "correct": False},
                {"text": "Это осталось от древних традиций.", "correct": False}
            ]
        },
        {
            "text": "Какой самый опасный вид магии?",
            "answers": [
                {"text": "Некромантия. Она нарушает естественный порядок.", "correct": False},
                {"text": "Разум. Она способна сломать личность.", "correct": True},
                {"text": "Пространство. Ошибка в расчётах — и ты потерян.", "correct": False}
            ]
        },
        {
            "text": "Что делает артефакт по-настоящему мощным?",
            "answers": [
                {"text": "Редкость материалов, из которых он создан.", "correct": False},
                {"text": "Сила мага, который его зачаровал.", "correct": False},
                {"text": "История и намерение, заложенные в него.", "correct": True}
            ]
        },
        {
            "text": "Можно ли создать магию из ничего?",
            "answers": [
                {"text": "Нет, энергия не возникает без источника.", "correct": True},
                {"text": "Да, если иметь достаточно знаний.", "correct": False},
                {"text": "Магия сама решает, где появиться.", "correct": False}
            ]
        },
        {
            "text": "Что отличает истинного мага от простого волшебника?",
            "answers": [
                {"text": "Истинный маг не использует слова, лишь мысли.", "correct": False},
                {"text": "Истинный маг понимает, когда НЕ использовать магию.", "correct": True},
                {"text": "Истинный маг рождается с даром, а волшебник учится.", "correct": False}
            ]
        },
        {
            "text": "Какой самый сложный аспект магического ритуала?",
            "answers": [
                {"text": "Чёткое произнесение заклинаний.", "correct": False},
                {"text": "Поддержание концентрации на протяжении всего ритуала.", "correct": True},
                {"text": "Использование редких ингредиентов.", "correct": False}
            ]
        },
        {
            "text": "Что сильнее — магия или воля?",
            "answers": [
                {"text": "Магия. Даже сильный дух не устоит перед мощными заклятиями.", "correct": False},
                {"text": "Воля. Истинный маг подчиняет магию своему разуму.", "correct": True},
                {"text": "Они равны. Магия без воли хаотична, а воля без магии слаба.", "correct": False}
            ]
        },
        {
            "text": "Можно ли превзойти естественные пределы магии?",
            "answers": [
                {"text": "Да, если нарушить законы мира.", "correct": False},
                {"text": "Только если найти новый источник силы.", "correct": True},
                {"text": "Нет, магия подчиняется строгим правилам.", "correct": False}
            ]
        },
        {
            "text": "Какую роль играет эмоция в магии?",
            "answers": [
                {"text": "Она может усиливать заклинания, но делает их нестабильными.", "correct": True},
                {"text": "Эмоции мешают магу. Истинный маг хладнокровен.", "correct": False},
                {"text": "Без эмоций магия просто не работает.", "correct": False}
            ]
        },
        {
            "text": "Почему некоторые маги теряют разум?",
            "answers": [
                {"text": "Они погружаются слишком глубоко в знания, не предназначенные для смертных.", "correct": True},
                {"text": "Они используют слишком много энергии разом.", "correct": False},
                {"text": "Магия вытягивает их жизненную силу.", "correct": False}
            ]
        },
        {
            "text": "Можно ли полностью подавить магию в человеке?",
            "answers": [
                {"text": "Нет, магия всегда найдёт способ проявиться.", "correct": False},
                {"text": "Да, с помощью особых печатей или артефактов.", "correct": True},
                {"text": "Только если уничтожить его источник силы.", "correct": False}
            ]
        },
        {
            "text": "Что произойдёт, если переплести несколько заклинаний одновременно?",
            "answers": [
                {"text": "Заклинания усилят друг друга.", "correct": False},
                {"text": "Заклинания могут сплестись в нечто новое... или взорваться.", "correct": True},
                {"text": "Одно из них просто поглотит другое.", "correct": False}
            ]
        },
        {
            "text": "Как узнать, что магия достигла своего предела?",
            "answers": [
                {"text": "Когда маг больше не чувствует потока энергии.", "correct": False},
                {"text": "Когда даже простейшие заклинания становятся нестабильными.", "correct": True},
                {"text": "Когда тело начинает разрушаться от перегрузки.", "correct": False}
            ]
        }
    ]



define last_magic_knowlenge_win = False

label start_magic_knowlenge_training(character, your_int):
    $ import random
    $ selected_questions = random.sample(magic_questions, 3)
    $ score = 0
    $ win_score = 3  # Количество правильных ответов для победы

    if is_cheats:
        menu:
            "У вас включены читы. Пропустить мини-игру?"
            "Играть":
                pause .01
            "Пропустить":
                $score = win_score
                call end_magic_knowlenge(character)
                return

    # Проходимся по каждому вопросу
    python:
        for question in selected_questions:
            renpy.say(character, question["text"])  # Выводим текст вопроса

            # Создаём меню для ответов
            choices = []
            for answer in question["answers"]:
                choices.append((answer["text"], answer["correct"]))  # Теперь передаём кортежи

            # Ожидание ответа игрока
            result = renpy.display_menu(choices)

            # Проверяем, был ли ответ правильным
            if result:
                score += 1

    call end_charisma_training(character)
    return


label end_magic_knowlenge(character):
    if score >= win_score:
        $ last_magic_knowlenge_win = True
        "Ты ответил правильно на все вопросы!"
    else:
        $ last_magic_knowlenge_win = False
        "Похоже, тебе ещё стоит потренироваться..."

    return
