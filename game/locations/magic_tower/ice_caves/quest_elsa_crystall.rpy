# Определяем персонажей
define p = Character("[hero_name]", color="#ffffff")
define e = Character("Эльза", color="#b0e0e6")
define em = Character("Эмилия", color="#dda0dd")


# Встреча с Эмилией в пещерах
label quest_elsa_crystall_start:
    scene bg ice_caves with fade
    "Ты заходишь в ледяные пещеры, и холод пробирает до костей."
    "Перед тобой — ледяные големы, охраняющие что-то в глубине."
    "Ты замечаешь фигуру, закованную в мерцающие ледяные цепи."
    show emilia captured at center with dissolve
    # Эмилия в цепях, её лицо выражает усталость, но глаза полны решимости
    em "Кто... кто ты? Ты пришёл освободить меня или тоже за кристаллом?"
    p "Я [hero_name]. Ищу 'Кристалл зимнего эха' для Эльзы. А ты как здесь оказалась?"
    em "Меня зовут Эмилия... Я пыталась взять кристалл, чтобы усилить свою магию, но эти големы схватили меня."
    em "Они... сильнее, чем я думала. Пожалуйста, помоги мне выбраться!"

    menu:
        "Освободить её без условий":
            jump free_emilia
        "Предложить сделку за её освобождение":
            jump deal_with_emilia

# Вариант 1: Освободить без условий
label free_emilia:
    scene bg ice_caves with fade
    "Ты подходишь к ледяным цепям и разбиваешь их ударом или магией."
    show emilia freed at center with dissolve
    # Эмилия свободна, её лицо озаряется благодарной улыбкой
    em "Спасибо, [hero_name]! Я не думала, что кто-то поможет мне просто так."
    p "Не за что. Кристалл всё ещё здесь?"
    em "Да, он там, в глубине. Я покажу тебе."
    "Эмилия ведёт тебя к кристаллу, её шаги легки, несмотря на усталость."
    scene bg ice_caves_crystal with fade
    # Кристалл сияет в центре пещеры
    em "Вот он. Бери, ты его заслужил."
    "Ты забираешь 'Кристалл зимнего эха'."
    show emilia freed at center with dissolve
    em "Ещё раз спасибо... Я не знаю, как отблагодарить тебя."
    "Она внезапно наклоняется и мягко целует тебя в щёку, её губы прохладны, но нежны."
    em "Будь осторожен, [hero_name]. Может, мы ещё встретимся."
    p "Надеюсь на это."
    "Эмилия уходит в глубину пещер, а ты возвращаешься к Эльзе."
    jump elsa_quest_ice_resonance_reward

# Вариант 2: Предложить сделку
label deal_with_emilia:
    scene bg ice_caves with fade
    show emilia captured at center with dissolve
    p "Я могу тебя освободить, но это опасное место. Что ты предложишь взамен?"
    em "Взамен? Я... у меня нет ничего ценного здесь."
    p "Тогда, может, ты сама станешь моей наградой?"
    "Эмилия краснеет, её глаза расширяются от удивления, но она быстро отводит взгляд."
    em "Ты... серьёзно? Я не уверена, что это правильно, но..."
    em "Если ты меня освободишь, я... соглашусь. Это мой выбор."
    menu:
        "Принять её согласие":
            jump emilia_sex_scene
        "Передумать и освободить её просто так":
            jump free_emilia

# Сцена секса с Эмилией (добровольная)
label emilia_sex_scene:
    scene bg ice_caves with fade
    "Ты разбиваешь ледяные цепи, и [em.name] встаёт, потирая запястья."
    show emilia freed at center with dissolve
    em "Спасибо... Я обещала, и я сдержу слово."
    "Она делает шаг ближе, её лицо всё ещё краснеет, но в глазах — решимость."
    scene bg emilia_sex1 at Transform(zoom=1.5) with dissolve
    # Эмилия стоит близко, её одежда слегка приспущена, открывая плечи
    em "Я... не очень опытна в этом, но я хочу, чтобы ты знал — это моё решение."
    p "Ты уверена?"
    em "Да, [hero_name]. Я доверяю тебе."
    scene bg emilia_sex2 at Transform(zoom=1.5) with dissolve
    # Она опускается перед тобой, её руки касаются твоей одежды
    "Эмилия медленно расстёгивает твою одежду, её пальцы дрожат, но она не отступает."
    scene bg emilia_sex3 at Transform(zoom=1.5) with dissolve
    # Ты входишь в неё, её тело напрягается, но она не отстраняется
    "Ты бережно обнимаешь её, и вскоре пещера наполняется тихими звуками её дыхания."
    em "Ах... это... теплее, чем я ожидала..."
    scene bg emilia_sex4 at Transform(zoom=1.5) with flash
    # Кульминация: ты кончаешь, Эмилия лежит рядом, её лицо выражает смесь смущения и облегчения
    "Ты достигаешь предела, и [em.name] мягко опускается на холодный пол, её кожа покрыта лёгким румянцем."
    em "Ты... сделал это. Теперь кристалл твой."
    scene bg ice_caves_crystal with fade
    "Она указывает на кристалл, и ты забираешь его."
    show emilia freed at center with dissolve
    em "Я не забуду тебя, [hero_name]. Будь осторожен."
    p "Ты тоже."
    "Эмилия уходит в глубину пещер, а ты отправляешься обратно к Эльзе."
    jump elsa_quest_ice_resonance_reward

# Награда от Эльзы
label elsa_quest_ice_resonance_reward:
    scene bg tower_training with fade
    "Ты возвращаешься в башню, держа в руках мерцающий 'Кристалл зимнего эха'."
    show e neutral at center with dissolve
    p "Вот твой кристалл, Эльза."
    e smile_shy "Ты... и правда его достал? Дай взглянуть."
    "Она берёт кристалл, её пальцы слегка дрожат от восторга, но она быстро скрывает это за привычной холодностью."
    e smirk "Неплохо, [hero_name]. Даже я впечатлена."
    p "Рад стараться. Так что насчёт награды?"
    e smile_closed_eyes "Терпение. Я же сказала, что подумаю."
    e smirk "Но ты заслужил нечто... особенное. Следуй за мной."
    # Здесь можно добавить сцену награды от Эльзы, например, call blowjob_elsa
    scene bg elsa_tower_room with fade
    show e smile at center with dissolve
    e "Ты снова доказал, что на тебя можно положиться, [hero_name]."
    e "Возвращайся, когда захочешь. У меня всегда найдётся для тебя дело."
    return