define first_time_training_ground = True
define battle_location_training_ground = "training_ground"
label training_ground:
    call training_ground_scene from _call_training_ground_scene

    if first_time_training_ground and isMorning():
        $ first_time_training_ground = False
        "Ты попадаешь на тренировочную площадку — просторную открытую зону, где собрались бойцы разного уровня. Кто-то отрабатывает удары по деревянным манекенам, кто-то тренируется с напарником, а кто-то отдыхает, потирая ушибленные места."
        "Воздух наполнен звуками ударов, выкриков и тяжёлого дыхания. Здесь пахнет землёй, потом и немного — кровью. Вдалеке виднеются груды оружия: деревянные мечи, копья и даже тренировочные топоры."

        "Ты начинаешь осматриваться, когда внезапно замечаешь нечто... странное."
        "В одном из углов площадки стоит девушка с огненно-рыжими волосами, сжимающая в руках деревянный меч. Она с невероятной скоростью и яростью атакует тренировочный манекен, раз за разом оставляя на нём вмятины."
        
        "Кажется, она даже не замечает окружающих, полностью погрузившись в свою тренировку."

        show eris training at center with dissolve
        "Но затем, в один момент, её резкий удар отбивает манекен в сторону... прямо на тебя!"

        menu:
            "Манекен летит в твою сторону... прямо на тебя!"
            "Попытаться увернуться":
                if strength > 20:
                    "Ты молниеносно реагируешь, делая шаг в сторону. Манекен с глухим стуком падает на землю прямо рядом с тобой."
                    eris "О! Ты довольно быстрый!"
                else:
                    "Ты не успеваешь среагировать, и манекен сбивает тебя с ног, прижимая к земле."
                    eris "Ха! Если даже от этого увернуться не можешь, что ты тут вообще забыл?"
                    "Ты чувствуешь, как что-то внутри тебя закипает — то ли от боли, то ли от обиды."

            "Попытаться остановить манекен":
                if strength > 30:
                    "Ты выставляешь руки вперёд и ловишь манекен, удерживая его на месте. Тяжёлый, но тебе хватает силы, чтобы не упасть."
                    eris "О! Так ты не такой уж слабак!"
                else:
                    "Ты пытаешься остановить манекен, но он сбивает тебя с ног, и ты падаешь на спину."
                    eris "Ха! Что, переоценил себя?"

            "Не двигаться":
                "Ты остаёшься на месте, надеясь, что манекен не ударит тебя слишком сильно."
                "Плохая идея. Он сбивает тебя с ног, и ты приземляешься на землю с глухим стуком."
                eris "Пф-ф! Ты даже не попытался увернуться? Да ты вообще кто?"

        "Девушка наконец замечает тебя и подходит ближе, держа меч на плече."

        eris "Ты чего тут стоишь, как истукан? Если ты не тренируешься, то лучше вали отсюда!"

        p "Эм... я только пришёл. Осматриваюсь."

        eris "Осматриваешься? Пфф! Бойцы не 'осматриваются' — они тренируются!" 
        "Она резко указывает мечом на ближайшее деревянное оружие."
        eris "Давай, бери что-нибудь и покажи, на что способен!"

        menu:
            eris "Давай, бери что-нибудь и покажи, на что способен!"
            "Взять деревянный меч":
                "Ты поднимаешь деревянный меч и принимаешь боевую стойку."
                eris "Ха! Посмотрим, можешь ли ты хотя бы нормально ударить!"

                "[eris.name] делает резкий выпад, атакуя тебя!"
                
                call start_battle(120, eris_str, eris.name, battle_location_training_ground) from _call_start_battle_24
                
                if last_battle_win:
                    "Ты успеваешь парировать её атаку и даже немного оттеснить её назад."
                    eris "Оу! Да ты не такой уж бесполезный!"
                    "Она одобрительно кивает, убирая меч."
                    $addLove("eris", 10)
                else:
                    "Ты не успеваешь среагировать, и её удар сбивает тебя с ног."
                    eris "Фу-у, даже неинтересно!"
                eris smile "Есть захочешь повторить - можешь найти меня здесь по утрам." with dissolve 
                $nextTime()

            "Отказаться":
                p "Знаешь, я пока не готов."
                eris "Не готов?! Что значит 'не готов'? Это же всего лишь тренировка! Или ты просто трус?"
                "Она фыркает и поворачивается обратно к манекену."
                eris @angry "Есть передумаешь - можешь найти меня. Я тренируюсь по утрам." with dissolve 

        "Ты понимаешь, что эта девушка — настоящий ураган. Тренироваться с ней явно будет нелегко."
        
    "Ты на тренировочной площадке в городе."
    jump training_ground_menu

label training_ground_menu:
    hide eris
    menu:
        "Качаться":
            # добавить вызов песни подход, подход, еще подход
            call start_muscule("Подход",2.3) from _call_start_muscule_4
            if last_muscule_win:
                call start_muscule("Подход",2.5) from _call_start_muscule_5
                if last_muscule_win:
                    call start_muscule("Еще подход",2.7) from _call_start_muscule_6
                    if last_muscule_win:
                        call start_muscule("Сотру со лба я легкий пот",2.7) from _call_start_muscule_7
                        if last_muscule_win:
                            "Я определенно становлюсь все лучше!"
                            $addChar(["str"], 2)
            $nextTime()
            jump training_ground_menu
            "Надо больше заниматься"
            jump training_ground_menu
        "Подойти к [eris.name]" if isMorning():
            jump training_ground_eris_menu
        "Отправиться в город":
            jump city

label training_ground_eris_menu:
    show eris with dissolve
    "Ты подошел к [eris.name]"
    menu:
        "Спарринг":
            call start_battle(120, eris_str, eris.name, battle_location_training_ground) from _call_start_battle_25
            if last_battle_win:
                "IN PROGRESS"
                $addChar(["str"], 2)
                $addLove("eris", 5)
                $addNPCStr("eris", 10)
            else:
                "IN PROGRESS"
            $nextTime()
            jump training_ground_menu
        "Пойти на задание вдвоем" if isNoQuestNow() and eris_love >= 40:
            call eris_quest_menu
            jump training_ground_eris_menu
        "Вернуться":
            jump training_ground

label eris_quest_menu:
    eris "Отличная идея!"
    menu:
        "IN PROGRESS":
            eris "IN PROGRESS"
            #jump eris_quest_dragon_hunting
        "IN PROGRESS":
            eris "IN PROGRESS"
            #jump eris_quest_goblin_hunting
        "Передумал":
            eris "IN PROGRESS"
            return
    return